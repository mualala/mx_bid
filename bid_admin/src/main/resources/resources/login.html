<!DOCTYPE html>
<html>

<head>
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta charset="UTF-8">

    <title> - 登录</title>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link href="./framework/css/font-awesome.min.css?v=4.4.0" rel="stylesheet">

    <link href="./framework/css/animate.css" rel="stylesheet">
    <link href="./framework/css/style.css?v=4.1.0" rel="stylesheet">
    <!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html"/>
    <![endif]-->
    <script>if (window.top !== window.self) {
        window.top.location = window.location;
    }</script>
</head>

<style>
    body {
        background: url(images/login_backgroud03.jpg) no-repeat;
        -webkit-background-size: cover;
    }

    #main {
        background: rgba(250, 250, 250, 0.2);
        border-radius: 3px;
    }
</style>

<body class="gray-bg">
    <div class="middle-box text-center loginscreen animated fadeInDown">
        <div>
            <div>
                <h3 class="logo-name">Meixin</h3>
            </div>
            <h2>欢迎使用 采购后台</h2>
            <div id="main">
                <form class="m-t" role="form" action="/admin/login" method="post">
                    <div id="errorInfo" class="row hidden">
                        <div class="alert alert-danger" role="alert">登录失败! <strong> 账号或密码错误</strong></div>
                    </div>
                    <p class="text-muted text-center">&nbsp;</p>
                    <div class="form-group">
                        <input id="username" type="text" name="username" class="form-control" placeholder="用户名" required="">
                    </div>
                    <div class="form-group">
                        <input id="password" type="password" name="password" class="form-control" placeholder="密码" required="">
                    </div>

                    <button id="login" class="btn btn-primary block full-width m-b">登 录</button>
                    <p class="text-muted text-center">
                        <a href="#"><small>忘记密码了？</small></a> | <a href="#">注册一个新账号</a>
                    </p>
                </form>
            </div>
        </div>
    </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>
<script src="./myjs/utils.js"></script>
<script>
    $('form').submit(function () {
        return false;
    });

    $('#login').click(function () {
        var username = $('#username').val();
        var password = $('#password').val();
        $.ajax({
            url: "/admin/login",
            type: "post",
            contentType: "application/x-www-form-urlencoded",
            // dataType: "json",
            data: {username: username, password: password},
            success: function (resp) {
                console.log('登录成功')
                console.log(resp)
                location.href = '/index.html';
                utils.storage.setSession('username', username);
            },
            error: function (xhr, textStatus, errorThrown) {
//                var status = xhr.status;
                utils.storage.delSession('username')
                $('#errorInfo').removeClass('hidden')
            }
        });
    });
</script>

</body>

</html>
